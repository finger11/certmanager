<!-- index.html -->
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>인증서관리시스템</title>
  <link rel="stylesheet" href="./styles.css" />
  <!-- Excel 업로드: SheetJS -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>

<body>
  <!-- ===== 메인: 인증서조회 Master만 표시 ===== -->
  <header class="topbar">
    <div class="topbar__title">인증서 조회 Master</div>
    <div class="topbar__actions">
      <button class="btn" id="btnOpenModelMaster">모델 편성하기</button>
      <button class="btn btn--primary" id="btnOpenRegMaster">인증서 등록하기</button>
      <button class="btn" id="btnExport">Export(JSON)</button>
      <button class="btn btn--danger" id="btnReset">초기화</button>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="card__body">
        <div class="filters">
          <div class="field">
            <label>모델명</label>
            <input class="input" id="fModelName" placeholder="예: RC620" />
          </div>
          <div class="field">
            <label>발급기관</label>
            <input class="input" id="fIssuer" placeholder="예: 한국환경산업기술원" />
          </div>
          <div class="field">
            <label>종류</label>
            <input class="input" id="fType" placeholder="예: 환경표지 인증서" />
          </div>
          <div class="field">
            <label>가스구분</label>
            <input class="input" id="fGas" placeholder="예: LNG" />
          </div>

          <div class="field span2">
            <label>유효기간</label>
            <div class="row">
              <input class="input" id="fValidFrom" type="date" />
              <span class="muted">~</span>
              <input class="input" id="fValidTo" type="date" />
              <button class="btn btn--primary" id="btnSearch">검색</button>
            </div>
          </div>
        </div>

        <div class="tableWrap">
          <table class="table" id="certTable"></table>
        </div>
      </div>
    </section>
  </main>

  <!-- =========================
       팝업들(기본 숨김)
  ========================== -->

  <!-- ======= 팝업: 모델 Master ======= -->
  <div class="modalBack" id="modalModelMaster" aria-hidden="true">
    <div class="modal">
      <div class="modal__head">
        <div class="modal__title">모델 Master</div>
        <button class="iconBtn" data-close="modalModelMaster" aria-label="닫기">✕</button>
      </div>
      <div class="modal__body">
        <div class="hint">
          엑셀 컬럼: <b>제품코드</b>, <b>모델명</b>, <b>가스구분</b>
          (또는 product_code/model_name/gas_type)
        </div>

        <div class="row">
          <input type="file" id="modelFile" accept=".xlsx,.xls" />
          <button class="btn btn--primary" id="btnImportModels">업로드</button>
          <button class="btn" id="btnDownloadModelTemplate">템플릿</button>
        </div>
        <div class="small muted" id="modelImportResult"></div>

        <hr class="hr" />

        <div class="row">
          <input class="input" id="modelFilter" placeholder="모델/제품코드 검색" />
          <button class="btn" id="btnAddModelManual">수기 추가</button>
        </div>

        <div class="tableWrap">
          <table class="table" id="modelTable"></table>
        </div>
      </div>
      <div class="modal__foot">
        <button class="btn" data-close="modalModelMaster">닫기</button>
      </div>
    </div>
  </div>

  <!-- ======= 팝업: 등록 Master ======= -->
  <div class="modalBack" id="modalRegMaster" aria-hidden="true">
    <div class="modal modal--wide">
      <div class="modal__head">
        <div class="modal__title">등록 Master</div>
        <button class="iconBtn" data-close="modalRegMaster" aria-label="닫기">✕</button>
      </div>

      <div class="modal__body">
        <div class="grid2">
          <div>
            <label class="label">적용대상</label>
            <input class="input" id="regScope" value="다수" readonly />
          </div>
          <div class="row align-end">
            <button class="btn" id="btnOpenTargetPicker">검색</button>
            <div class="small muted" id="pickedCount">선택 0건</div>
          </div>
        </div>

        <label class="label">성적서(인증서)번호</label>
        <input class="input" id="regCertNo" placeholder="예: 26830" />

        <label class="label">종류</label>
        <input class="input" id="regType" placeholder="예: 환경표지 인증서" />

        <label class="label">발급기관</label>
        <input class="input" id="regIssuer" placeholder="예: 한국환경산업기술원" />

        <div class="grid3">
          <div>
            <label class="label">발급일자</label>
            <input class="input" id="regIssued" type="date" />
          </div>
          <div>
            <label class="label">유효기간(From)</label>
            <input class="input" id="regValidFrom" type="date" />
          </div>
          <div>
            <label class="label">유효기간(To)</label>
            <input class="input" id="regValidTo" type="date" />
          </div>
        </div>

        <div class="row">
          <label class="check">
            <input type="checkbox" id="regNoExpiry" />
            유효기간 없음
          </label>
        </div>

        <label class="label">파일업로드(PDF 등)</label>
        <div class="row">
          <input class="input" id="regFilePath" placeholder="선택된 파일명" readonly />
          <input type="file" id="regFile" />
        </div>

        <label class="label">메모(선택)</label>
        <textarea class="input" id="regMemo" rows="3"></textarea>
      </div>

      <div class="modal__foot">
        <button class="btn btn--primary" id="btnSaveCert">적용</button>
        <button class="btn" data-close="modalRegMaster">닫기</button>
      </div>
    </div>
  </div>

  <!-- ======= 팝업: 적용대상 지정하기 ======= -->
  <div class="modalBack" id="modalTargetPicker" aria-hidden="true">
    <div class="modal modal--wide">
      <div class="modal__head">
        <div class="modal__title">적용대상 지정하기</div>
        <button class="iconBtn" data-close="modalTargetPicker" aria-label="닫기">✕</button>
      </div>
      <div class="modal__body">
        <div class="row">
          <label class="label" style="margin:0">모델명</label>
          <input class="input" id="tpKeyword" placeholder="예: RC620" />
          <button class="btn" id="btnTpSearch">검색</button>
        </div>

        <div class="tableWrap">
          <table class="table" id="targetTable"></table>
        </div>

        <div class="row">
          <button class="btn" id="btnTpSelectAll">전체선택</button>
          <button class="btn" id="btnTpClear">전체해제</button>
        </div>
      </div>

      <div class="modal__foot">
        <button class="btn btn--primary" id="btnTpApply">적용</button>
        <button class="btn" data-close="modalTargetPicker">닫기</button>
      </div>
    </div>
  </div>

  <!-- ======= 팝업: 적용대상 확인하기 ======= -->
  <div class="modalBack" id="modalTargetView" aria-hidden="true">
    <div class="modal modal--wide">
      <div class="modal__head">
        <div class="modal__title">적용대상 조회</div>
        <button class="iconBtn" data-close="modalTargetView" aria-label="닫기">✕</button>
      </div>
      <div class="modal__body">
        <div class="tableWrap">
          <table class="table" id="targetViewTable"></table>
        </div>
      </div>
      <div class="modal__foot">
        <button class="btn" data-close="modalTargetView">닫기</button>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
